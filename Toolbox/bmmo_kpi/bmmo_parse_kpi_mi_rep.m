function kpi_mi = bmmo_parse_kpi_mi_rep(kpi_rep_mi)
%
% function kpi_mi = bmmo_parse_kpi_mi_rep(kpi_rep_mi)
%
%Given the Mirror Correction Magnitude KPIs (wafer, full) from the OTAS job report, parse the
%contents into a BMMO-NXE kpi structure
% Input:
%   kpi_rep_mi: Mirror Correction Magnitude KPIs (wafer, full) from the job report
%
% Output:
%   kpi_mi: Mirror KPI (wafer, full) Correction Magnitude structure as generated by
%   BMMO model
%
% Changelog
% 20171030 SBPR Creation

rep_map = {'XTY', ...
    'YTX', ...
    'Wafer', ...
    'Full', ...
    'Max', ...
    'Max99.7', ...
    'M3s', ...
    'Chuck1', ...
    'Chuck2'};

kpi_map = {'xty', ...
    'ytx', ...
    'wafer', ...
    'full', ...
    'max', ...
    '997', ...
    'm3s', ...
    'chk1', ...
    'chk2'};

mimaps = [1 2];
wfr = [3 4];
stats = [5 6 7];
chucks = [8 9];


for imap = mimaps
    for iwfr = wfr
        for istat = stats
            for ichk = chucks
                fname = ['ovl_exp_' kpi_map{imap} '_' kpi_map{istat} '_' kpi_map{iwfr} '_' kpi_map{ichk}];
                val = kpi_rep_mi.(rep_map{imap}).(rep_map{iwfr}).(rep_map{istat}).(rep_map{ichk});
                kpi_mi.(fname) = str2double(val) * 1e-9;
            end
        end
    end
end