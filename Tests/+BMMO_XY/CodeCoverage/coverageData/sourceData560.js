var sourceData560 = {"FileContents":["function mlo = bmmo_import_ADELwaferdatamap(ADEL_wdm, wdm_type, select_corrs, make_ppt)\r","% function mlo = bmmo_import_ADELwaferdatamap(ADEL_wdm, wdm_type, select_corrs, make_ppt)\r","%\r","% Load the waferdata maps from an ADELwaferdatamap xml file generated\r","% by a BMMO NXE job into an ml structure with the same layout as the\r","% input_struct to BMMO NXE drift control model\r","%\r","% If the function is run without any input, a dialog box is opened to choose the\r","% options\r","%\r","% Input:    ADEL_wdm: full path of ADEL_waferdatamap file\r","%           wdm_type: cell array of the wdms to import, containing (a subset\r","%           of):\r","%           {'total_unfiltered', 'total_filtered', 'uncontrolled'};\r","%\r","%           select_corrs: cell array with the corrections to import,\r","%           containing (a subset of): {'WH','MI','KA','BAO','Intrafield','TotalSBCcorrection'}\r","%           make_ppt: Generates ppt if true (default)\r","%\r","%\r","% Output:   mlo:    matlab struct containing the different waferdatamaps\r","%                   as substructures\r","%\r","% Example usage: bmmo_import_ADELwaferdatamap to choose ADEL file and wdms\r","%                to import in the gui, ppt creation enabled by default\r","%\r","%                mlo = bmmo_import_ADELwaferdatamap(ADEL_wdm_file_path,...\r","%                       {uncontrolled}, {''}, false) to import only the\r","%                       uncontrolled wdms into an ml struct (no ppt\r","%                       generated)             \r","%\r","% 20190726 SELR Creation\r","% 20191213 SELR Same scale for per chuck correction set\r","% 20200417 SELR Bugfix\r","\r","\r","% Show popup dialog if no file specified\r","wdm_type_list = {'total_unfiltered', 'total_filtered', 'uncontrolled'};\r","corr_list = {'WH','MI','KA','BAO','Intrafield','TotalSBCcorrection'};\r","if nargin < 1 || isempty(ADEL_wdm)\r","    [filename, pathname, ~] = uigetfile( ...\r","        {'*.xml', 'ADELwaferDataMap (*.xml)'},...   % File pattern\r","        'Select ADELwaferDataMap',...               % Dialog title\r","        '',...                                      % Default filename\r","        'MultiSelect', 'off'...                      % Allow multiple?\r","        );\r","    if isnumeric(filename) && filename == 0\r","        mlo = [];\r","        warning('bmmo_import_ADELwaferdatamap:file_selection_aborted','Operation cancelled by user.');\r","        return;\r","    else\r","        ADEL_wdm = fullfile(pathname, filename);\r","    end\r","end\r","if nargin < 2\r","    wdm_type_index = listdlg('PromptString', 'Select an image:',...\r","        'ListSize', [300, 100], 'ListString', wdm_type_list);\r","    wdm_type = wdm_type_list(wdm_type_index);\r","end\r","if nargin < 3 && (wdm_type_index(1) ~= 3 && wdm_type_index(1) ~= 4)\r","    select_corrections_index = listdlg('PromptString', 'Select an image:',...\r","        'ListSize', [300, 200], 'ListString', corr_list);\r","    select_corrs = corr_list(select_corrections_index);\r","elseif nargin < 3\r","    select_corrs = {};\r","end\r","if nargin < 4\r","    make_ppt = 1;\r","end\r","\r","mlo = bmmo_parse_ADELwaferdatamap(ADEL_wdm);\r","mlo = sub_remove_not_selected(mlo, wdm_type, wdm_type_list, select_corrs, corr_list);\r","n_wdm_types = length(wdm_type);\r","n_corrs = length(select_corrs);\r","if n_corrs > 3\r","    n_corr_plot = 3;\r","else\r","    n_corr_plot = n_corrs;\r","end\r","field_names = fieldnames(mlo);\r","if make_ppt\r","    openppt('new');\r","    close all;\r","    for iwdm_type = 1:n_wdm_types\r","        title = sub_get_slide_title(wdm_type(iwdm_type), wdm_type_list);\r","        newslide(title);\r","        if strcmp(wdm_type(iwdm_type), 'uncontrolled')\r","            scale.(wdm_type{iwdm_type}) = sub_get_scale(mlo.uncontrolled_meas(1), mlo.uncontrolled_meas(2));\r","            figure;bmmo_plot(mlo.uncontrolled_meas(1), 'scale', scale.(wdm_type{iwdm_type}), 'title', 'Uncontrolled c1');\r","            figppt(1,[1,2,1],'bitmap');\r","            figure;bmmo_plot(mlo.uncontrolled_meas(2), 'scale', scale.(wdm_type{iwdm_type}), 'title', 'Uncontrolled c2');\r","            figppt(2,[1,2,2],'bitmap');\r","            close all\r","        else\r","            for icorr = 1:n_corrs\r","                if icorr == 4\r","                    newslide([title '(2)']);\r","                    iplot = icorr - 3;\r","                elseif icorr > 4\r","                    iplot = icorr - 3;\r","                else\r","                    iplot = icorr;\r","                end\r","                \r","                plot_ind = contains(field_names, wdm_type(iwdm_type)) & contains(field_names, select_corrs(icorr));\r","                plot_field = field_names{plot_ind};\r","                \r","                if ~strcmp(select_corrs(icorr), 'WH')\r","                    scale.(plot_field) = sub_get_scale(mlo.(plot_field)(1), mlo.(plot_field)(2));\r","                    figure;bmmo_plot(mlo.(plot_field)(1), 'scale', scale.(plot_field), 'title', [select_corrs{icorr} ' c1']);\r","                    figppt(1,[2,n_corr_plot,iplot],'bitmap');\r","                    figure;bmmo_plot(mlo.(plot_field)(2), 'scale', scale.(plot_field), 'title', [select_corrs{icorr} ' c2']);\r","                    figppt(2,[2,n_corr_plot,iplot+n_corr_plot],'bitmap');\r","                else\r","                    figure;bmmo_plot(mlo.(plot_field)(1), 'scale', 0, 'title', [select_corrs{icorr} ' c1']);\r","                    figppt(1,[2,n_corr_plot,iplot],'bitmap');\r","                end\r","                close all\r","            end\r","        end\r","    end\r","end\r","\r","\r","function title = sub_get_slide_title(wdm_type, wdm_type_list)\r","\r","wdm_title_list = {'Total unfiltered', 'Total filtered', 'Uncontrolled measurement'};\r","index = strcmp(wdm_type, wdm_type_list);\r","title = wdm_title_list{index};\r","\r","\r","function mlo = sub_remove_not_selected(mlo, wdm_type, wdm_type_list, select_corrs, corr_list)\r","\r","wdm_remove = setdiff(wdm_type_list, wdm_type);\r","corr_remove = setdiff(corr_list, select_corrs);\r","\r","field_names = fieldnames(mlo);\r","\r","remove_ind = contains(field_names, wdm_remove) | contains(field_names, corr_remove);\r","remove_field_names = field_names(remove_ind);\r","mlo = rmfield(mlo, remove_field_names);\r","\r","\r","function scale = sub_get_scale(ml1, ml2)\r","\r","mli = ovl_combine_wafers(ml1, ml2);\r","ovl = ovl_calc_overlay(mli);\r","scale = 1e-9*ceil(1e9*max([ovl.ox997 ovl.oy997]));\r","% when content is sub-nm, zoom in even further\r","if scale < 1.1e-9\r","    scale = 1e-10*ceil(1e10*max([ovl.ox997 ovl.oy997]));\r","end\r","% catch net: MINIMUM scale is 0.1 nm (unless explicitly overriden through option)\r","if scale < 0.1e-9\r","    scale = 0.1e-9;\r","end"],"CoverageData":{"CoveredLineNumbers":[],"UnhitLineNumbers":[38,39,40,41,47,48,49,50,51,52,55,56,57,58,60,61,62,63,64,65,67,68,71,72,73,74,75,76,77,78,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,105,106,108,109,110,111,112,113,114,115,116,118,127,128,129,134,135,137,139,140,141,146,147,148,150,151,154,155],"HitCount":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}}