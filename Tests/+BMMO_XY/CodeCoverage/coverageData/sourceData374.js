var sourceData374 = {"FileContents":["function kpi_corr = bmmo_parse_kpi_corr_lis(kpi_rep, stats_rep)\r","%\r","% function kpi_corr = bmmo_parse_kpi_corr_lis(kpi_rep,stats_rep)\r","%\r","%Given the Correction Magnitude KPIs and statistics from the LIS job report, parse the\r","%contents into a BMMO-NXE kpi structure\r","% Input:\r","%   kpi_rep:   Correction Magnitude KPIs from job report\r","%   stats_rep: Correction Magnitude stats from job report\r","%\r","% Output:\r","%   kpi_corr: KPI Correction Magnitude structure as generated by bmmo_nxe_drift_control_model\r","%\r","% Changelog\r","% 20200812  ANBZ Creation\r","% 20201119  OGIE Update for intra_33_par\r","\r","kpi_fields     = {'delta_filtered', 'total_filtered'};\r","kpi_fields2    = {'delta_unfiltered', 'total_unfiltered'};\r","rep_fields     = {'DeltaFilteredCalibration' 'TotalFilteredCalibration'};\r","rep_fields2    = {'DeltaUnfilteredCalibration' 'TotalUnfilteredCalibration'};\r","rep_kf_fields  = {'DeltaFilteredMonitoring', 'TotalFilteredMonitoring'};\r","rep_kf_fields2 = {'DeltaUnfilteredMonitoring', 'TotalUnfilteredMonitoring'};\r","\r","% Filtered, KPI 99.7 and m3sigma\r","for ii = 1:length(rep_fields)\r","    %Mirror\r","    kpi_corr.(kpi_fields{ii}).mirror.exp =  bmmo_parse_kpi_mi_rep_lis(kpi_rep(1).(rep_fields{ii}).MirrorExposure,...\r","        kpi_rep(2).(rep_fields{ii}).MirrorExposure,'kpi');\r","    kpi_corr.(kpi_fields{ii}).mirror.meas =   bmmo_parse_kpi_mi_rep_lis(stats_rep(1).(rep_fields{ii}).MirrorMeasure,...\r","        stats_rep(2).(rep_fields{ii}).MirrorMeasure, 'all');\r","    \r","    %Wafer heating\r","    kpi_corr.(kpi_fields{ii}).waferheating.ovl_exp_grid_whc = str2double(kpi_rep(3).(rep_fields{ii}).WaferHeating.WaferHeatingIrEuvRatio);\r","    \r","    % KA grid (when enabled)\r","    if isfield(kpi_rep(1).(rep_fields{ii}),'KaExposureGrid')\r","        kpi_corr.(kpi_fields{ii}).grid.exp = bmmo_parse_kpi_overlay_lis(kpi_rep(1).(rep_fields{ii}).KaExposureGrid,...\r","            kpi_rep(2).(rep_fields{ii}).KaExposureGrid, 'kpi');\r","    end\r","    if isfield(stats_rep(1).(rep_fields{ii}),'KaMeasureGrid')\r","        kpi_corr.(kpi_fields{ii}).grid.meas = bmmo_parse_kpi_overlay_lis(stats_rep(1).(rep_fields{ii}).KaMeasureGrid,...\r","            stats_rep(2).(rep_fields{ii}).KaMeasureGrid, 'all');\r","    end\r","    \r","    % BAO metrics\r","    kpi_corr.(kpi_fields{ii}).bao = bmmo_parse_kpi_overlay_lis(kpi_rep(1).(rep_fields{ii}).BaoMetrics,...\r","        kpi_rep(2).(rep_fields{ii}).BaoMetrics, 'kpi');\r","    \r","    % Total correction overlay\r","    kpi_corr.(kpi_fields{ii}).total = bmmo_parse_kpi_overlay_lis(kpi_rep(1).(rep_fields{ii}).CorrectionOverlayMetrics,...\r","        kpi_rep(2).(rep_fields{ii}).CorrectionOverlayMetrics,'kpi');\r","    \r","    % Intrafield metrics\r","    if isfield(kpi_rep(1).(rep_fields{ii}),'Intrafield18ParMetrics')\r","        % Intrafield 18 par metrics\r","        kpi_corr.(kpi_fields{ii}).intra_18_par = bmmo_parse_kpi_overlay_lis(kpi_rep(1).(rep_fields{ii}).Intrafield18ParMetrics,...\r","            kpi_rep(2).(rep_fields{ii}).Intrafield18ParMetrics, 'kpi');\r","    else\r","        % Intrafield 33 par metrics\r","        kpi_corr.(kpi_fields{ii}).intra_33_par = bmmo_parse_kpi_overlay_lis(kpi_rep(1).(rep_fields{ii}).Intrafield33ParMetrics,...\r","            kpi_rep(2).(rep_fields{ii}).Intrafield33ParMetrics, 'kpi');\r","    end\r","    \r","    % SUSD (when enabled)\r","    if isfield(kpi_rep(1).(rep_fields{ii}),'Susd')\r","        kpi_corr.(kpi_fields{ii}).susd.ovl_exp_grid_chk1_ty_susd  =  str2double(kpi_rep(1).(rep_fields{ii}).Susd.Translation.Y) * 1e-9;\r","        kpi_corr.(kpi_fields{ii}).susd.ovl_exp_grid_chk2_ty_susd  =  str2double(kpi_rep(2).(rep_fields{ii}).Susd.Translation.Y) * 1e-9;\r","    end\r","end\r","\r","\r","% Filtered, KPI max and 3sigma\r","for ii = 1:length(rep_fields)\r","    % BAO metrics\r","    kpin_corr.(kpi_fields{ii}).bao = bmmo_parse_kpi_overlay_lis(stats_rep(1).(rep_fields{ii}).BaoMetrics,...\r","        stats_rep(2).(rep_fields{ii}).BaoMetrics, 'kpi2');\r","    \r","    % BAO paramters\r","    kpin_corr.(kpi_fields{ii}).bao = bmmo_parse_kpi_bao_rep_lis(kpin_corr.(kpi_fields{ii}).bao,...\r","        stats_rep(1).(rep_fields{ii}).Bao, stats_rep(2).(rep_fields{ii}).Bao);\r","    \r","    % KA grid (when enabled)\r","    if  isfield(stats_rep(1).(rep_fields{ii}),'KaExposureGrid')\r","        kpin_corr.(kpi_fields{ii}).grid.exp   = bmmo_parse_kpi_overlay_lis(stats_rep(1).(rep_fields{ii}).KaExposureGrid,...\r","            stats_rep(2).(rep_fields{ii}).KaExposureGrid, 'kpi2');\r","    end\r","    \r","    \r","    if  isfield(stats_rep(1).(rep_fields{ii}),'Clamp')\r","        kpin_corr.(kpi_fields{ii}).clamp   =  bmmo_parse_clamp_pi_lis(stats_rep(1).(rep_fields{ii}).Clamp,...\r","            stats_rep(2).(rep_fields{ii}).Clamp, 'modelled');\r","        kpi_corr.(kpi_fields{ii}).clamp  = kpin_corr.(kpi_fields{ii}).clamp; \r","    end\r","    % Mirror\r","    kpin_corr.(kpi_fields{ii}).mirror.exp = bmmo_parse_kpi_mi_rep_lis(stats_rep(1).(rep_fields{ii}).MirrorExposure,...\r","        stats_rep(2).(rep_fields{ii}).MirrorExposure,'kpi2');\r","    \r","    % Intrafield raw metrics\r","    kpin_corr.(kpi_fields{ii}).intra_raw = bmmo_parse_kpi_overlay_lis(stats_rep(1).(rep_fields{ii}).IntrafieldRawFingerprintMetrics,...\r","        stats_rep(2).(rep_fields{ii}).IntrafieldRawFingerprintMetrics, 'all');\r","    \r","    % Total correction overlay\r","    kpin_corr.(kpi_fields{ii}).total = bmmo_parse_kpi_overlay_lis(stats_rep(1).(rep_fields{ii}).CorrectionOverlayMetrics,...\r","        stats_rep(2).(rep_fields{ii}).CorrectionOverlayMetrics,'kpi2');\r","    \r","    if isfield(stats_rep(1).(rep_fields{ii}), 'Intrafield18ParMetrics')\r","        % Intrafield 18 par metrics\r","        kpin_corr.(kpi_fields{ii}).intra_18_par = bmmo_parse_kpi_overlay_lis(stats_rep(1).(rep_fields{ii}).Intrafield18ParMetrics,...\r","        stats_rep(2).(rep_fields{ii}).Intrafield18ParMetrics, 'kpi2');\r","    else\r","        % Intrafield 33 par metrics\r","        kpin_corr.(kpi_fields{ii}).intra_33_par = bmmo_parse_kpi_overlay_lis(stats_rep(1).(rep_fields{ii}).Intrafield33ParMetrics,...\r","        stats_rep(2).(rep_fields{ii}).Intrafield33ParMetrics, 'kpi2');\r","    end\r","    \r","    % K-factor metrics\r","    kpi_corr.(kpi_fields{ii}).k_factors = bmmo_parse_kpi_overlay_lis(stats_rep(1).(rep_kf_fields{ii}).KFactorsMetrics,...\r","        stats_rep(2).(rep_kf_fields{ii}).KFactorsMetrics, 'all');\r","    \r","    % K-factors (k7-k20 for 20par, or selection from k7-k51 for 35par)\r","    kpi_corr.(kpi_fields{ii}).k_factors = bmmo_parse_kpi_ho_rep_lis(kpi_corr.(kpi_fields{ii}).k_factors,...\r","        stats_rep(1).(rep_kf_fields{ii}).KFactors, stats_rep(2).(rep_kf_fields{ii}).KFactors);\r","    \r","    % copy filtered Intrafield raw metrics to kpi_corr struct \r","    kpi_corr.(kpi_fields{ii}).intra_raw = kpin_corr.(kpi_fields{ii}).intra_raw;  \r","  \r","    % copy remaining metrics (Max and 3s) of filtered to kpi_corr from kpin corr\r","    f2 = fieldnames(kpin_corr.(kpi_fields{ii}));\r","    for iii = 1:length(f2)\r","        kpi_corr.(kpi_fields{ii}).(f2{iii}) = bmmo_add_missing_fields(kpi_corr.(kpi_fields{ii}).(f2{iii}), kpin_corr.(kpi_fields{ii}).(f2{iii}), 2);\r","    end   \r","end\r","\r","\r","% statistics Unfiltered (99.7, m3sigma, max, 3sigma)\r","for ii = 1:length(rep_fields2)\r","    \r","    % Wafer heating\r","    kpi1_corr.(kpi_fields2{ii}).waferheating.ovl_exp_grid_whc =  str2double(stats_rep(3).(rep_fields2{ii}).WaferHeating.WaferHeatingIrEuvRatio);\r","    \r","    % Intrafield raw metrics\r","    kpi1_corr.(kpi_fields2{ii}).intra_raw = bmmo_parse_kpi_overlay_lis(stats_rep(1).(rep_fields2{ii}).IntrafieldRawFingerprintMetrics,...\r","        stats_rep(2).(rep_fields2{ii}).IntrafieldRawFingerprintMetrics, 'all');\r","    \r","    % SUSD (when enabled)\r","    if isfield(stats_rep(1).(rep_fields2{ii}),'Susd')\r","        kpi1_corr.(kpi_fields2{ii}).susd.ovl_exp_grid_chk1_ty_susd  =  str2double(stats_rep(1).(rep_fields2{ii}).Susd.Translation.Y) * 1e-9;\r","        kpi1_corr.(kpi_fields2{ii}).susd.ovl_exp_grid_chk2_ty_susd  =  str2double(stats_rep(2).(rep_fields2{ii}).Susd.Translation.Y) * 1e-9;\r","    end\r","    \r","    % Mirror \r","    kpi1_corr.(kpi_fields2{ii}).mirror.exp =  bmmo_parse_kpi_mi_rep_lis(stats_rep(1).(rep_fields2{ii}).MirrorExposure,...\r","        stats_rep(2).(rep_fields2{ii}).MirrorExposure, 'all');\r","        kpi1_corr.(kpi_fields2{ii}).mirror.meas =   bmmo_parse_kpi_mi_rep_lis(stats_rep(1).(rep_fields2{ii}).MirrorMeasure,...\r","        stats_rep(2).(rep_fields2{ii}).MirrorMeasure, 'all');\r","    \r","    % KA (when enabled)\r","    if isfield(stats_rep(1).(rep_fields2{ii}),'KaExposureGrid')\r","        kpi1_corr.(kpi_fields2{ii}).grid.exp = bmmo_parse_kpi_overlay_lis(stats_rep(1).(rep_fields2{ii}).KaExposureGrid,...\r","            stats_rep(2).(rep_fields2{ii}).KaExposureGrid, 'all');\r","    end\r","    if isfield(stats_rep(1).(rep_fields2{ii}),'KaMeasureGrid')\r","        kpi1_corr.(kpi_fields2{ii}).grid.meas = bmmo_parse_kpi_overlay_lis(stats_rep(1).(rep_fields2{ii}).KaMeasureGrid,...\r","            stats_rep(2).(rep_fields2{ii}).KaMeasureGrid, 'all');\r","    end\r","    \r","    % BAO metrics\r","    kpi1_corr.(kpi_fields2{ii}).bao = bmmo_parse_kpi_overlay_lis(stats_rep(1).(rep_fields2{ii}).BaoMetrics,...\r","        stats_rep(2).(rep_fields2{ii}).BaoMetrics, 'all');\r","    \r","    % BAO paramters\r","    kpi1_corr.(kpi_fields2{ii}).bao = bmmo_parse_kpi_bao_rep_lis(kpi1_corr.(kpi_fields2{ii}).bao,...\r","        stats_rep(1).(rep_fields2{ii}).Bao, stats_rep(2).(rep_fields2{ii}).Bao);\r","    \r","    % Total correction overlay\r","    kpi1_corr.(kpi_fields2{ii}).total = bmmo_parse_kpi_overlay_lis(stats_rep(1).(rep_fields2{ii}).CorrectionOverlayMetrics,...\r","        stats_rep(2).(rep_fields2{ii}).CorrectionOverlayMetrics, 'all');\r","    \r","    if isfield(stats_rep(1).(rep_fields2{ii}), 'Intrafield18ParMetrics')\r","        % Intrafield 18 par metrics\r","        kpi1_corr.(kpi_fields2{ii}).intra_18_par  = bmmo_parse_kpi_overlay_lis(stats_rep(1).(rep_fields2{ii}).Intrafield18ParMetrics,...\r","            stats_rep(2).(rep_fields2{ii}).Intrafield18ParMetrics, 'all');\r","    else\r","        % Intrafield 33 par metrics\r","        kpi1_corr.(kpi_fields2{ii}).intra_33_par  = bmmo_parse_kpi_overlay_lis(stats_rep(1).(rep_fields2{ii}).Intrafield33ParMetrics,...\r","            stats_rep(2).(rep_fields2{ii}).Intrafield33ParMetrics, 'all');\r","        \r","    end\r","    \r","    % K-factors metrics\r","    kpi1_corr.(kpi_fields2{ii}).k_factors = bmmo_parse_kpi_overlay_lis(stats_rep(1).(rep_kf_fields2{ii}).KFactorsMetrics,...\r","        stats_rep(2).(rep_kf_fields2{ii}).KFactorsMetrics, 'all');\r","    \r","    % K-factors (k7-k20 for 20par, or selection from k7-k51 for 35par)\r","    kpi1_corr.(kpi_fields2{ii}).k_factors = bmmo_parse_kpi_ho_rep_lis(kpi1_corr.(kpi_fields2{ii}).k_factors,...\r","        stats_rep(1).(rep_kf_fields2{ii}).KFactors,stats_rep(2).(rep_kf_fields2{ii}).KFactors);\r","end\r","\r","% copy unfiltered metrics from kpi1_corr to kpi_corr\r","kpi_corr = bmmo_add_missing_fields(kpi_corr, kpi1_corr, 2);\r","\r","\r","% Delta Monitoring General  KPIs\r","% SUSD\r","kpi_corr.monitor.susd.ovl_exp_grid_chk1_ty_susd = str2double(stats_rep(1).DeltaMonitoringGeneral.SuSd.Translation.Y) * 1e-9;\r","kpi_corr.monitor.susd.ovl_exp_grid_chk2_ty_susd = str2double(stats_rep(2).DeltaMonitoringGeneral.SuSd.Translation.Y) * 1e-9;\r","\r","% K-factors (k7-k20 for 20par, or selection from k7-k51 for 35par)\r","kpi_corr.monitor.intra_delta = bmmo_parse_kpi_ho_rep_lis([], stats_rep(1).DeltaMonitoringGeneral.DeltaKFactors,...\r","    stats_rep(2).DeltaMonitoringGeneral.DeltaKFactors, true);\r","\r","\r","\r",""],"CoverageData":{"CoveredLineNumbers":[18,19,20,21,22,23,26,28,29,30,31,34,37,38,39,41,42,43,47,48,51,52,55,57,58,59,61,62,66,67,68,74,76,77,80,81,84,85,86,90,91,92,93,96,97,100,101,104,105,107,109,110,111,113,114,118,119,122,123,126,129,130,131,137,140,143,144,147,148,149,153,154,155,156,159,160,161,163,164,165,169,170,173,174,177,178,180,182,183,184,186,187,192,193,196,197,201,206,207,210,211],"UnhitLineNumbers":[],"HitCount":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,4,4,0,0,4,0,8,8,8,8,0,0,8,0,0,8,6,6,0,8,2,2,0,0,0,8,8,0,0,8,8,0,0,8,0,6,6,2,0,2,2,0,0,0,8,6,6,0,0,0,0,0,4,0,8,8,0,0,8,8,0,0,8,6,6,0,0,0,8,1,1,1,0,0,8,8,0,0,8,8,0,0,8,8,0,8,0,6,6,2,0,2,2,0,0,0,8,8,0,0,8,8,0,0,8,0,0,8,8,47,0,0,0,0,0,4,0,0,8,0,0,8,8,0,0,8,6,6,0,0,0,8,8,8,8,0,0,8,6,6,0,8,2,2,0,0,0,8,8,0,0,8,8,0,0,8,8,0,8,0,6,6,2,0,2,2,0,0,0,0,8,8,0,0,8,8,0,0,0,4,0,0,0,0,4,4,0,0,4,4,0,0,0,0]}}