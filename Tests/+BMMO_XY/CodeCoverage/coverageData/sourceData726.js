var sourceData726 = {"FileContents":["function mlo = bmmo_add_random_noise(mli,option,tstd,layer)\r","% function mlo = bmmo_add_random_noise(mli,option,tstd)\r","%\r","% This function replaces the dx and dy per wafer, per layer in mli with a\r","% given level of random noise\r","%\r","% Input:\r","% mli: Input tlg\r","% option: type of noise, can be 'mirror' or 'mark'\r","% tstd: 3 sigma of the noise\r","%\r","% Output:\r","% mlo: same structure as mli\r","%\r","% For details of the model and definitions of in/out interfaces, refer to\r","% D000323756 EDS BMMO NXE drift control model\r","%\r","% 20150616 MoZH Creation\r","\r","mlo = mli;\r","\r","if nargin < 2\r","    option = 'mark';\r","end\r","\r","if nargin < 3\r","    tstd = 3;\r","end\r","\r","if nargin < 4\r","    layer = 1:mli.nlayer; % if no layer defined, add to the top layer\r","end\r","\r","% find marks outside 150mm\r","ido = (sqrt(mlo.wd.xw.^2+mlo.wd.yw.^2)>=0.15);\r","\r","for ilayer = 1:length(layer)\r","    this_layer = layer(ilayer);\r","    for iwafer = 1:mli.nwafer\r","        switch(option)\r","            case 'mirror'\r","                noise_x = tstd/3*randn(1,401)*1e-9;\r","                noise_y = tstd/3*randn(1,401)*1e-9;\r","                noise = interp1(-0.2:0.001:0.2,noise_x,mli.wd.yw,'linear');\r","                mlo.layer(this_layer).wr(iwafer).dx = noise;\r","                noise = interp1(-0.2:0.001:0.2,noise_y,mli.wd.xw,'linear');\r","                mlo.layer(this_layer).wr(iwafer).dy = noise;\r","            case 'mark'\r","                mlo.layer(this_layer).wr(iwafer).dx(ido) = NaN;\r","                mlo.layer(this_layer).wr(iwafer).dy(ido) = NaN;\r","                idx = ~isnan(mlo.layer(this_layer).wr(iwafer).dx);\r","                idy = ~isnan(mlo.layer(this_layer).wr(iwafer).dy);\r","                mlo.layer(this_layer).wr(iwafer).dx(idx) = tstd/3*randn(size(mlo.layer(this_layer).wr(iwafer).dx(idx)))*1e-9;\r","                mlo.layer(this_layer).wr(iwafer).dy(idy) = tstd/3*randn(size(mlo.layer(this_layer).wr(iwafer).dy(idy)))*1e-9;\r","            otherwise \r","                error('bmmo_add_random_noise: option is not recognised');\r","        end\r","    end\r","end\r","\r","\r","\r",""],"CoverageData":{"CoveredLineNumbers":[20,22,23,26,27,30,31,35,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54],"UnhitLineNumbers":[55,56],"HitCount":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,31,0,31,27,0,0,31,31,0,0,31,31,0,0,0,31,0,31,31,31,182,182,6,6,6,6,6,6,176,176,176,176,176,176,176,0,0,0,0,0,0,0,0,0]}}