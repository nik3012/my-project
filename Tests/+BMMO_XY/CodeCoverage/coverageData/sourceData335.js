var sourceData335 = {"FileContents":["classdef testBmmoSubModelIntraf < BMMO_XY.tools.testSuite\r","    \r","    methods(Static)\r","        \r","        %% Sub function\r","        function intra_out = sub_remove_6par(intra_in)\r","            intra_out = intra_in;            \r","            for ic = 1:2\r","                intra_out.Calib_intra(ic) = ovl_model(intra_out.Calib_intra(ic));\r","                [~, intra_out.Calib_Kfactors(ic)] =  ovl_model(intra_out.Calib_intra(ic), '18par,d3,flw3y');\r","                [intra_out.residual(ic), intra_out.par18(ic)] = ovl_model(intra_out.Calib_intra(ic), '18par');                \r","            end\r","        end\r","        \r","    end\r","    \r","    methods(Test)\r","        \r","        %% 1. Basic regression test\r","        function Case1(obj)\r","            % Given\r","            load([bmmo_testdata_root filesep 'sub_model_input_basic.mat']);\r","            load([bmmo_testdata_root filesep 'sub_model_intraf_output_basic.mat']);            \r","            model_results.INTRAF = rmfield(model_results.INTRAF, 'Calib_Kfactors');\r","            model_results.INTRAF = rmfield(model_results.INTRAF, 'par18');            \r","            model_results.INTRAF.residual = bmmo_average_chuck(mli, options);\r","            model_results.WH.lambda = 0;\r","            model_results.SUSD.model_fp = model_results.WH.fp_per_chuck;\r","            options.WH.input_fp_per_chuck = model_results.WH.fp_per_chuck;\r","            newoptions = bmmo_default_options_structure;\r","            options.intraf_resample_options = newoptions.intraf_resample_options;\r","            options.x_shift = [0 0];\r","            options.y_shift = [0 0];\r","            options.susd_control = 0;\r","            options.platform = newoptions.platform;\r","            options.KA_actuation = newoptions.KA_actuation;\r","            options = bmmo_options_intraf(options,3);            \r","            model_results.intrafield_input = model_results.INTRAF.residual;   \r","            \r","            % When\r","            results_intra.INTRAF = obj.sub_remove_6par(results_intra.INTRAF);            \r","            test_results = bmmo_sub_model_INTRAF(model_results, options);\r","            \r","            % Then\r","            obj.verifyWithinTol(test_results.INTRAF.Calib_intra, results_intra.INTRAF.Calib_intra);\r","            obj.verifyWithinTol(test_results.INTRAF.residual, results_intra.INTRAF.residual);\r","        end\r","        \r","        %% 2. Regression test; check result on residual of WH submodel, results of KA, MI, BAO submodels\r","        function Case2(obj)\r","            % Given\r","            load([bmmo_testdata_root filesep 'sub_model_intraf_input.mat']);\r","            load([bmmo_testdata_root filesep 'sub_model_intraf_output.mat']);            \r","            results_bao_ka_mi_wh.INTRAF.residual = res_wh;\r","            results_bao_ka_mi_wh.INTRAF = rmfield(results_bao_ka_mi_wh.INTRAF, 'Calib_Kfactors');\r","            results_bao_ka_mi_wh.INTRAF = rmfield(results_bao_ka_mi_wh.INTRAF, 'par18');\r","            options.WH.input_fp_per_chuck = results_bao_ka_mi_wh.WH.fp_per_chuck;\r","            results_bao_ka_mi_wh.WH.lambda = 0;         % WH has already been removed from example input\r","            results_bao_ka_mi_wh.SUSD.model_fp = results_bao_ka_mi_wh.WH.fp_per_chuck;\r","            newoptions = bmmo_default_options_structure;\r","            options.intraf_resample_options = newoptions.intraf_resample_options;\r","            options.x_shift = [0 0];\r","            options.y_shift = [0 0];\r","            options.susd_control = 0;\r","            options.KA_actuation = newoptions.KA_actuation;\r","            options.platform = newoptions.platform;\r","            options = bmmo_options_intraf(options,3);            \r","            results_bao_ka_mi_wh.intrafield_input = results_bao_ka_mi_wh.INTRAF.residual;\r","            \r","            % When\r","            test_results = bmmo_sub_model_INTRAF(results_bao_ka_mi_wh, options);\r","            results_intraf_bao_ka_mi_wh.INTRAF = obj.sub_remove_6par(results_intraf_bao_ka_mi_wh.INTRAF);\r","            \r","            % Then\r","            obj.verifyWithinTol(test_results.INTRAF.Calib_intra, results_intraf_bao_ka_mi_wh.INTRAF.Calib_intra, 'tol', 5e-11);\r","            obj.verifyWithinTol(test_results.INTRAF.residual, results_intraf_bao_ka_mi_wh.INTRAF.residual, 'tol', 5e-11);\r","        end\r","        \r","    end\r","    \r","end\r",""],"CoverageData":{"CoveredLineNumbers":[7,8,9,10,11,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,41,42,45,46,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,71,72,75,76],"UnhitLineNumbers":[],"HitCount":[0,0,0,0,0,0,2,2,4,4,4,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,1,1,0,0,1,1,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,1,1,0,0,1,1,0,0,0,0,0,0]}}