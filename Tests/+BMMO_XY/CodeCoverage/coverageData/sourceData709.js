var sourceData709 = {"FileContents":["function test_suite = test_bmmo_sub_model_INTRAF %#ok<STOUT>\r","\r","suite = initTestSuite2016(localfunctions);\r","if nargout==0\r","    suite.run();\r","else\r","    test_suite = suite;\r","end\r","\r","\r","%1. Basic regression test \r","function test_bmmo_sub_model_INTRAF_case1 % ok<DEFNU>\r","\r","load([bmmo_testdata_root filesep 'sub_model_input_basic.mat']);\r","load([bmmo_testdata_root filesep 'sub_model_intraf_output_basic.mat']);\r","\r","model_results.INTRAF = rmfield(model_results.INTRAF, 'Calib_Kfactors');\r","model_results.INTRAF = rmfield(model_results.INTRAF, 'par18');\r","\r","model_results.INTRAF.residual = bmmo_average_chuck(mli, options);\r","model_results.WH.lambda = 0;\r","model_results.SUSD.model_fp = model_results.WH.fp_per_chuck;\r","options.WH.input_fp_per_chuck = model_results.WH.fp_per_chuck;\r","newoptions = bmmo_default_options_structure;\r","options.intraf_resample_options = newoptions.intraf_resample_options;\r","options.x_shift = [0 0];\r","options.y_shift = [0 0];\r","options.susd_control = 0;\r","options.platform = newoptions.platform;\r","options.KA_actuation = newoptions.KA_actuation;\r","options = bmmo_options_intraf(options,3);\r","\r","model_results.intrafield_input = model_results.INTRAF.residual;\r","\r","results_intra.INTRAF = sub_remove_6par(results_intra.INTRAF);\r","\r","test_results = bmmo_sub_model_INTRAF(model_results, options);\r","\r","bmmo_assert_equal(test_results.INTRAF.Calib_intra, results_intra.INTRAF.Calib_intra);\r","bmmo_assert_equal(test_results.INTRAF.residual, results_intra.INTRAF.residual);\r","\r","\r","%2. Regression test; check result on residual of WH submodel, results of KA, MI, BAO submodels \r","function test_bmmo_sub_model_INTRAF_case2 % ok<DEFNU>\r","\r","load([bmmo_testdata_root filesep 'sub_model_intraf_input.mat']);\r","load([bmmo_testdata_root filesep 'sub_model_intraf_output.mat']);\r","\r","results_bao_ka_mi_wh.INTRAF.residual = res_wh;\r","results_bao_ka_mi_wh.INTRAF = rmfield(results_bao_ka_mi_wh.INTRAF, 'Calib_Kfactors');\r","results_bao_ka_mi_wh.INTRAF = rmfield(results_bao_ka_mi_wh.INTRAF, 'par18');\r","options.WH.input_fp_per_chuck = results_bao_ka_mi_wh.WH.fp_per_chuck;\r","results_bao_ka_mi_wh.WH.lambda = 0; % WH has already been removed from example input\r","results_bao_ka_mi_wh.SUSD.model_fp = results_bao_ka_mi_wh.WH.fp_per_chuck;\r","newoptions = bmmo_default_options_structure;\r","options.intraf_resample_options = newoptions.intraf_resample_options;\r","options.x_shift = [0 0];\r","options.y_shift = [0 0];\r","options.susd_control = 0;\r","options.KA_actuation = newoptions.KA_actuation;\r","options.platform = newoptions.platform;\r","options = bmmo_options_intraf(options,3);\r","\r","results_bao_ka_mi_wh.intrafield_input = results_bao_ka_mi_wh.INTRAF.residual;\r","test_results = bmmo_sub_model_INTRAF(results_bao_ka_mi_wh, options);\r","results_intraf_bao_ka_mi_wh.INTRAF = sub_remove_6par(results_intraf_bao_ka_mi_wh.INTRAF);\r","\r","bmmo_assert_equal(test_results.INTRAF.Calib_intra, results_intraf_bao_ka_mi_wh.INTRAF.Calib_intra, 5e-11);\r","bmmo_assert_equal(test_results.INTRAF.residual, results_intraf_bao_ka_mi_wh.INTRAF.residual, 5e-11);\r","\r","\r","function intra_out = sub_remove_6par(intra_in)\r","\r","intra_out = intra_in;\r","\r","for ic = 1:2\r","   intra_out.Calib_intra(ic) = ovl_model(intra_out.Calib_intra(ic));\r","   [~, intra_out.Calib_Kfactors(ic)] =  ovl_model(intra_out.Calib_intra(ic), '18par,d3,flw3y');\r","   [intra_out.residual(ic), intra_out.par18(ic)] = ovl_model(intra_out.Calib_intra(ic), '18par');\r","\r","end"],"CoverageData":{"CoveredLineNumbers":[],"UnhitLineNumbers":[3,4,5,6,7,14,15,17,18,20,21,22,23,24,25,26,27,28,29,30,31,33,35,37,39,40,46,47,49,50,51,52,53,54,55,56,57,58,59,60,61,62,64,65,66,68,69,74,76,77,78,79],"HitCount":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}}