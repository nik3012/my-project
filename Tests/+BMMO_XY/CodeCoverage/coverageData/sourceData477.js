var sourceData477 = {"FileContents":["function bmmo_assert_equal_wdm_MATLAB_LIS(wdm, select_WDM, print_type, plot_type)\r","% function bmmo_assert_equal_wdm_MATLAB_LIS(wdm, select_WDM, print_type, plot_type)\r","%\r","% Wrapper for LIS SP validation of waferdatamaps: delta, no. of valids, plots of delta\r","% model and vcp.\r","%\r","% INPUTS\r","%\r","% wdm : struct containing:\r","%\r","% wdm.MATLAB : MATLAB waferdatamaps struct generated by bmmo nxe drift control\r","% model\r","%\r","% wdm.LIS : LIS waferdatamps struct parsed from ADELwdm files\r","%\r","% wdm.output :filename to output the assertion results,\r","% eg: 'output.txt' or provide outfile = stdout for printing to command line\r","%\r","% OPTIONAL INPUTS\r","%\r","% select_WDM: select which waferdatamaps to compare ('all' or subset e.g. 'SUSD')\r","% print_type = 0, shows if delta is OK/NOK and # of valids are matching\r","% print_type = 1, shows the delta for each chuck/wafer\r","% print_type = 2, shows the delta and number of valid points for each chuck/wafer\r","% plot_type  = 1, Plots the delta ovl plots for each chuck/wafer\r","% plot_type  = 2, Plots the Model,VCP and delta ovl plots for each chuck/wafer\r","\r","if nargin < 4\r","    plot_type = 0;   \r","else\r","    openppt('new')\r","end\r","\r","if nargin < 3\r","    print_type = 0;    \r","end\r","\r","if nargin < 3\r","    select_WDM = 'all';\r","end\r","\r","if isempty(wdm.output)\r","    outfile = stdout;\r","else\r","    if ischar(wdm.output)\r","        outfile = fopen(wdm.output, 'w');\r","        if contains(wdm.output, 'MATLABvsLIS')\r","            title = 'MATLAB vs LIS';\r","        end\r","    else\r","        outfile = wdm.output;\r","    end\r","end\r","\r","f2  = fieldnames(wdm.LIS);\r","corr = {'delta_unfiltered', 'total_unfiltered', 'total_filtered'};\r","\r","if sum(contains(f2,'33')) > 0\r","    Intra_pars = '33';\r","else\r","    Intra_pars = '18';\r","end\r","\r","if contains(select_WDM, 'all')\r","    str2 = {'Wafer_Heating','susd', 'Mirror_exposure','KA_exposure_grid','bao','Intrafield_raw','correction_overlay', ['Intrafield_nce_', Intra_pars, 'par']};\r","    str1 = {'WH','SUSD', 'MI','KA','BAO','INTRAF_raw','TotalSBCcorrection', ['INTRAF_',Intra_pars,'par_NCE']};\r","    str3 = {'model_residual','controlled_meas', 'controlled_meas_per_wafer', 'uncontrolled_meas', 'uncontrolled_meas_per_wafer', 'previous_actuated_inlineSDM'};\r","    str4 = {'residual_overlay','controlled_overlay', 'controlled_overlay_per_wafer', 'uncontrolled_overlay', 'uncontrolled_overlay_per_wafer', 'previous_actuated_inlineSDM' };\r","    \r","else\r","    str2 = {'Wafer_Heating','susd', 'Mirror_exposure','KA_exposure_grid','bao','Intrafield_raw','correction_overlay', ['Intrafield_nce_', Intra_pars, 'par']};\r","    str1 = {'WH','SUSD', 'MI','KA','BAO','INTRAF_raw','TotalSBCcorrection',['INTRAF_',Intra_pars,'par_NCE']};\r","    str3 = {'model_residual','controlled_meas', 'controlled_meas_per_wafer', 'uncontrolled_meas', 'uncontrolled_meas_per_wafer', 'previous_actuated_inlineSDM'};\r","    str4 = {'residual_overlay','controlled_overlay', 'controlled_overlay_per_wafer', 'uncontrolled_overlay', 'uncontrolled_overlay_per_wafer', 'previous_actuated_inlineSDM' };\r","    index = contains(str1, WDM);\r","    str2 = str2(index);\r","    str1 = str1(index);\r","    \r","    index = contains(str3, WDM);\r","    str3 = str3(index);\r","    str4 = str4(index);\r","end\r","\r","fprintf(outfile,['WDMs: ', title,'\\n\\n']);\r","\r","if any(contains(str2,'Intrafield'))\r","    tmp = wdm.MATLAB;\r","    for ichk = 1:2\r","        wdm.MATLAB.delta_unfiltered.INTRAF_raw(ichk) = ovl_get_wafers(tmp.delta_unfiltered.INTRAF_raw,ichk);\r","        wdm.MATLAB.total_unfiltered.INTRAF_raw(ichk) = ovl_get_wafers(tmp.total_unfiltered.INTRAF_raw,ichk);\r","        wdm.MATLAB.total_filtered.INTRAF_raw(ichk) = ovl_get_wafers(tmp.total_filtered.INTRAF_raw,ichk);\r","        \r","        wdm.MATLAB.total_filtered.(str1{end})(ichk) = ovl_get_wafers(tmp.total_filtered.(str1{end}),ichk);\r","        wdm.MATLAB.total_unfiltered.(str1{end})(ichk) = ovl_get_wafers(tmp.total_unfiltered.(str1{end}),ichk);\r","        \r","        wdm.LIS.total_unfiltered_Intrafield_raw(ichk) = ovl_average_fields(wdm.LIS.total_unfiltered_Intrafield_raw(ichk));\r","        wdm.LIS.total_filtered_Intrafield_raw(ichk) = ovl_average_fields(wdm.LIS.total_filtered_Intrafield_raw(ichk));\r","        wdm.LIS.delta_unfiltered_Intrafield_raw(ichk) = ovl_average_fields(wdm.LIS.delta_unfiltered_Intrafield_raw(ichk));\r","        \r","        if sum(contains(f2,'33')) > 0\r","            wdm.LIS.total_filtered_Intrafield_nce_33par(ichk) = ovl_average_fields(wdm.LIS.total_filtered_Intrafield_nce_33par(ichk));\r","            wdm.LIS.total_unfiltered_Intrafield_nce_33par(ichk) = ovl_average_fields(wdm.LIS.total_unfiltered_Intrafield_nce_33par(ichk));\r","        else\r","            wdm.LIS.total_filtered_Intrafield_nce_18par(ichk) = ovl_average_fields(wdm.LIS.total_filtered_Intrafield_nce_18par(ichk));\r","            wdm.LIS.total_unfiltered_Intrafield_nce_18par(ichk) = ovl_average_fields(wdm.LIS.total_unfiltered_Intrafield_nce_18par(ichk));\r","        end\r","    end\r","end\r","\r","if any(contains(str4,'inline'))\r","    for ichk = 1:2\r","        wdm.LIS.previous_actuated_inlineSDM(ichk) = ovl_average_fields(wdm.LIS.previous_actuated_inlineSDM(ichk));\r","    end\r","end\r","\r","if any(contains(str3, 'uncontrolled_meas_per_wafer'))\r","    for iwafer = 1: wdm.MATLAB.controlled_meas_per_wafer.nwafer\r","        tmp1(iwafer) = ovl_get_wafers(wdm.MATLAB.uncontrolled_meas_per_wafer, iwafer);\r","    end\r","    wdm.MATLAB.uncontrolled_meas_per_wafer = tmp1;\r","end\r","\r","if any(contains(str3, 'controlled_meas_per_wafer'))\r","    for iwafer = 1: wdm.MATLAB.controlled_meas_per_wafer.nwafer\r","        tmp2(iwafer) = ovl_get_wafers(wdm.MATLAB.controlled_meas_per_wafer, iwafer);\r","    end\r","    wdm.MATLAB.controlled_meas_per_wafer = tmp2;\r","end\r","\r","for iii = 1:length(str1)\r","    if contains(str1{iii}, 'NCE')\r","        corr = {'total_unfiltered', 'total_filtered'};\r","    end\r","    \r","    if isfield(wdm.MATLAB.total_filtered, str1{iii}) && any(contains(f2, str2{iii}))\r","        for ii = 1:length(corr)\r","            mli1 = wdm.MATLAB.(corr{ii}).(str1{iii});\r","            mli2 = wdm.LIS.([corr{ii} '_' str2{iii}]);\r","            plot_name = [(corr{ii}) ' ' (str1{iii})];\r","            bmmo_delta_wdm_MATLAB_LIS(mli1, mli2, plot_name, print_type, plot_type, outfile)\r","        end\r","    end\r","end\r","\r","for iii = 1:length(str3)\r","    if  isfield(wdm.MATLAB, str3{iii}) && any(contains(f2, str4{iii}))\r","        mli1 = wdm.MATLAB.(str3{iii});\r","        mli2 = wdm.LIS.(str4{iii});\r","        plot_name = str4{iii};\r","        bmmo_delta_wdm_MATLAB_LIS(mli1, mli2, plot_name, print_type, plot_type, outfile)\r","    end\r","end\r","\r","end"],"CoverageData":{"CoveredLineNumbers":[],"UnhitLineNumbers":[28,29,30,31,34,35,38,39,42,43,44,45,46,47,48,50,51,55,56,58,59,60,61,64,65,66,67,68,70,71,72,73,74,75,76,77,79,80,81,84,86,87,88,89,90,91,93,94,96,97,98,100,101,102,103,104,105,110,111,112,116,117,118,120,123,124,125,127,130,131,132,135,136,137,138,139,140,145,146,147,148,149,150],"HitCount":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}}