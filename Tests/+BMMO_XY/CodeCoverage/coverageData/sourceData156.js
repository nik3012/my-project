var sourceData156 = {"FileContents":["function options = bmmo_options_intraf(options_in, order)\r","%function options = bmmo_options_intraf(options_in, order)\r","%\r","% This function will update intrafield model options to match the model\r","% order. If not provided, the model order in options_in is used.\r","% if not then defaults to 5th order.\r","% NOTE: It does change/set the options.INTRAF values used in for example\r","% outlier removal and fixing of NaN.\r","%\r","% Input \r","% options_in :  existing options structure\r","% order :       intrafield model order (3 or 5)\r","%\r","% Ouput \r","% options:      parsed options structure with updated intraf parameters\r","\r","if nargin<2\r","    if isfield(options_in, 'intraf_actuation_order')\r","       order = options_in.intraf_actuation_order ;\r","    else\r","       order = 5;\r","    end\r","end\r","\r","options = options_in;\r","options.intraf_actuation_order = order;\r","\r","if order == 3\r","    % Following option values are all for third order actuation modelling\r","    % CET parameters are 18par, which is full 20par minus 'd3', 'flw3y'\r","    options.intraf_CETpar.name = {'tx','ty','mx','my','rx','ry','d2','k8','k9','k10',...\r","        'bowxf','bowyf','mag3y','accx','accy','cshpx','cshpy','flw3x'};\r","    options.intraf_CETpar.scaling = [ 1e1*ones(1,6) 1e3*ones(1,6) 1e5*ones(1,6)];  % FP Scaling to make the matrix elements to be O(10^(-1))~O(1)\r","    % all 20parameters\r","    options.intraf_CETparfull.name = {'tx','ty','mx','my','rx','ry','d2','k8','k9','k10',...\r","        'bowxf','bowyf','d3','mag3y','accx','accy','cshpx','cshpy','flw3x','flw3y'};\r","    % field name for model_results.(Intra_NCE fields).INTRAF_18par_NCE\r","    options.intraf_nce_modelresult.name = 'INTRAF_18par_NCE';\r","    % field name for kpi.Intra_18par_NCE.(fields)\r","    options.intraf_nce_kpi.name = 'Intra_18par_NCE';\r","    % field name for kpi.correction.(fields).intra_18_par \r","    options.intraf_corr_par.name = 'intra_18_par';\r","    % model name for use with bmmo_fit_model\r","    options.intraf_fitmodel = '18par';\r","    options.intraf_fitmodel_all = '20par';\r","    % k-factors to report in hoc_pi_structure (k7-k20)\r","    options.intraf_hoc_pi.kfactors = {'d2','k8','k9','k10','bowxf','bowyf',...\r","        'd3','mag3y','accx','accy','cshpx','cshpy','flw3x','flw3y'};\r","elseif order == 5\r","    % Following option values are all for fifth order actuation modelling\r","    % CET parameters are 33par, which is full 35par minus 'd3', 'flw3y'\r","    options.intraf_CETpar.name = {'tx','ty','mx','my','rx','ry','d2','k8','k9','k10',...\r","        'bowxf','bowyf','mag3y','accx','accy','cshpx','cshpy','flw3x','k22',...\r","        'k24','k25','k26','k27','k29','k32','k34','k36','k37','k39','k41','k46','k48','k51'};\r","    options.intraf_CETpar.scaling = [ 1e1*ones(1,6) 1e3*ones(1,6) 1e5*ones(1,6) 1e7*ones(1,6) ...\r","        1e9*ones(1,6) 1e11*ones(1,3)];  % FP Scaling to make the matrix elements to be O(10^(-1))~O(1)\r","    % all 35 parameters\r","    options.intraf_CETparfull.name = {'tx','ty','mx','my','rx','ry','d2','k8','k9','k10',...\r","        'bowxf','bowyf','d3','mag3y','accx','accy','cshpx','cshpy','flw3x','flw3y','k22',...\r","        'k24','k25','k26','k27','k29','k32','k34','k36','k37','k39','k41','k46','k48','k51'};\r","    % field name for model_results.(Intra_NCE fields).INTRAF_18par_NCE\r","    options.intraf_nce_modelresult.name = 'INTRAF_33par_NCE';\r","    % field name for kpi.Intra_18par_NCE.(fields)\r","    options.intraf_nce_kpi.name = 'Intra_33par_NCE';\r","    % field name for kpi.correction.(fields).intra_33_par \r","    options.intraf_corr_par.name = 'intra_33_par';\r","    % model name for use with bmmo_fit_model\r","    options.intraf_fitmodel = '33par';\r","    options.intraf_fitmodel_all = '35par';\r","    % k-factors to report in hoc_pi_structure (k7-k20)\r","    options.intraf_hoc_pi.kfactors = {'d2','k8','k9','k10','bowxf','bowyf',...\r","        'd3','mag3y','accx','accy','cshpx','cshpy','flw3x','flw3y','k22',...\r","        'k24','k25','k26','k27','k29','k32','k34','k36','k37','k39','k41','k46','k48','k51'};\r","else\r","    error('Intrafield corrections order provided is not valid: %s. Supported orders are 3 and 5.', num2str(order))\r","end\r",""],"CoverageData":{"CoveredLineNumbers":[17,18,19,25,26,28,31,33,35,38,40,42,44,45,47,49,52,55,56,58,62,64,66,68,69,71],"UnhitLineNumbers":[20,21,74,75],"HitCount":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2991,52,52,0,0,0,0,0,2991,2991,0,2991,0,0,2967,0,2967,0,2967,0,0,2967,0,2967,0,2967,0,2967,2967,0,2967,0,24,0,0,24,0,0,24,24,0,24,0,0,0,24,0,24,0,24,0,24,24,0,24,0,0,0,0,0,0]}}