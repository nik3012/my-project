var sourceData38 = {"FileContents":["function [corr_out, kpi_out, zero_corr] = bmmo_apply_ewma_filter(model_results, options)\r","% function [corr_out, kpi_out, zero_corr] = bmmo_apply_ewma_filter(model_results, options)\r","%\r","% The function does the following:\r","  % Applies ewma time filtering on SBC correction.\r","  % Generates correction structures such as delta filtered/unfiltered and\r","  %   total filtered/ unfiltered. \r","  % Inserts zeros in the previous corrections that are disabled in the\r","  %   configuration (SUSD/KA/KA@M).\r","  % Removes 10 par from total filtered/unfiltered FFP\r","%\r","% Input:\r","%   model_results: intermediate model results\r","%   options: BMMO/BL3 options structure\r","%\r","% Output: \r","%   corr_out: BMMO/BL3 SBC correction structure (sent to TS)\r","%   kpi_out: structure containing the following SBC correction structures\r","%       delta_filtered\r","%       delta_unfiltered\r","%       total_filtered (equal to corr_out)\r","%       total_unfiltered\r","%   zero_corr: zero BMMO/BL3 SBC correction structuere\r","\r","% Initializations\r","zero_out = bmmo_default_output_structure(options);   \r","zero_corr = zero_out.corr;\r","\r","delta_corr = bmmo_fill_correction(zero_corr, model_results, options);\r","empty_filter = bmmo_get_empty_filter;\r","\r","delta_corr = bmmo_apply_time_filter(delta_corr, empty_filter, -1); % invert the sign of delta_corr\r","\r","\r","if options.undo_before_modelling > 0\r","     delta_corr = bmmo_add_output_corr(delta_corr, bmmo_apply_time_filter(options.previous_correction, empty_filter, -1));\r","end\r","\r","if ~options.KA_control\r","    for i=1:length(options.previous_correction.KA.grid_2de)\r","        options.previous_correction.KA.grid_2de(i).dx = options.previous_correction.KA.grid_2de(i).dx*0;\r","        options.previous_correction.KA.grid_2de(i).dy = options.previous_correction.KA.grid_2de(i).dy*0;\r","    end\r","end\r","\r","if ~options.KA_measure_enabled\r","    for i=1:length(options.previous_correction.KA.grid_2dc)\r","        options.previous_correction.KA.grid_2dc(i).dx = options.previous_correction.KA.grid_2dc(i).dx*0;\r","        options.previous_correction.KA.grid_2dc(i).dy = options.previous_correction.KA.grid_2dc(i).dy*0;\r","    end\r","end\r","\r","if ~options.susd_control\r","    for i=1:length(options.previous_correction.SUSD)\r","        options.previous_correction.SUSD(i).TranslationY = options.previous_correction.SUSD(i).TranslationY*0;\r","    end\r","end\r","\r","kpi_out.delta_filtered   =  bmmo_ewma_filter(delta_corr, zero_corr, options.filter.coefficients);\r","kpi_out.delta_unfiltered =  bmmo_ewma_filter(delta_corr, zero_corr, empty_filter);\r","kpi_out.total_filtered   =  bmmo_ewma_filter(delta_corr, options.previous_correction, options.filter.coefficients);\r","kpi_out.total_unfiltered =  bmmo_ewma_filter(delta_corr, options.previous_correction, empty_filter);\r","\r","kpi_out.delta_filtered   = bmmo_fix_KA_corr(kpi_out.delta_filtered);\r","kpi_out.delta_unfiltered = bmmo_fix_KA_corr(kpi_out.delta_unfiltered);\r","kpi_out.total_filtered   = bmmo_fix_KA_corr(kpi_out.total_filtered);\r","kpi_out.total_unfiltered = bmmo_fix_KA_corr(kpi_out.total_unfiltered);\r","\r","% recommendation after JIMI convergence study:\r","% remove 10par from total ffp output\r","kpi_out.total_filtered.ffp = bmmo_model_10par_ffp(kpi_out.total_filtered.ffp, options);\r","kpi_out.total_unfiltered.ffp = bmmo_model_10par_ffp(kpi_out.total_unfiltered.ffp, options);\r","\r","corr_out = kpi_out.total_filtered;\r",""],"CoverageData":{"CoveredLineNumbers":[26,27,29,30,32,35,39,40,41,42,46,47,48,49,53,54,55,59,60,61,62,64,65,66,67,71,72,74],"UnhitLineNumbers":36,"HitCount":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,127,127,0,127,127,0,127,0,0,127,0,0,0,127,120,240,240,0,0,0,127,120,240,240,0,0,0,127,104,416,0,0,0,127,127,127,127,0,127,127,127,127,0,0,0,127,127,0,127,0]}}