var sourceData752 = {"FileContents":["function out  = bmmo_k_factors_to_xml( in, nwafer, nfield )\r","% function k_factors  = bmmo_xml_to_k_factors( OverlayParam )\r","%\r","% Convert 18 k-factors to 18par parameters with the correct scale\r","\r","for iw = 1:nwafer\r","    for ifield = 1:nfield\r","        out.wafer(iw).field(ifield) = sub_k_factors_new(in.wafer(iw).field(ifield));\r","    end\r","end\r","\r","\r","function pars = sub_k_factors_new(k_factors)\r","\r","NM = 1;\r","UM = 1; % also the scaling factor for urad\r","NM_CM2 = 1;\r","NM_CM3 = 1;\r","\r","% declare parameter structure with scaling factors\r","pars = struct('K1', NM, 'K2', NM, 'ms', UM, 'ma', UM, 'rs', UM, 'ra', UM, ...\r","    'K7', NM_CM2, 'K8', NM_CM2, 'K9', NM_CM2, 'K10', NM_CM2, 'K11', NM_CM2, ...\r","    'K12', NM_CM2, 'K14', NM_CM3, 'K15', NM_CM3, 'K16', NM_CM3, 'K17', NM_CM3, ...\r","    'K18', NM_CM3, 'K19', NM_CM3);\r","\r","copied_fields = {'K1', 'K2', 'K7', 'K8', 'K9', 'K10', 'K11', 'K12', 'K14', 'K15', 'K16', 'K17', 'K18', 'K19'};\r","trans_fields = {'K3', 'K4', 'K5', 'K6'};\r","\r","\r","\r","if isfield(k_factors, 'k1')\r","    k_copied_fields = lower(copied_fields);\r","    k_trans_fields = lower(trans_fields);\r","else\r","    k_copied_fields = copied_fields;\r","    k_trans_fields = trans_fields;\r","end\r","\r","% Copy the fields that just require scaling\r","for fn = 1:length(copied_fields)\r","   pars.(copied_fields{fn}) =  k_factors.(k_copied_fields{fn}) * pars.(copied_fields{fn});\r","end\r","\r","\r","\r","% Convert the other parameters\r","pars.ms = pars.ms * (k_factors.(k_trans_fields{1}) + k_factors.(k_trans_fields{2})) / 2; % (ms + ma + ms - ma) / 2\r","pars.ma = pars.ma * (k_factors.(k_trans_fields{1}) - k_factors.(k_trans_fields{2})) / 2; % (ms + ma - (ms - ma)) / 2\r","pars.rs = pars.rs * -1 * ((k_factors.(k_trans_fields{3}) - k_factors.(k_trans_fields{4})) / 2); % -((-rs -ra -(rs - ra)) / 2)\r","pars.ra = pars.ra * -1 * ((k_factors.(k_trans_fields{3}) + k_factors.(k_trans_fields{4})) / 2); % -((-rs -ra +(rs - ra)) / 2)"],"CoverageData":{"CoveredLineNumbers":[6,7,8,15,16,17,18,21,22,23,24,26,27,31,34,35,36,40,41,47,48,49,50],"UnhitLineNumbers":[32,33],"HitCount":[0,0,0,0,0,7,36,3714,0,0,0,0,0,0,3714,3714,3714,3714,0,0,3714,3714,3714,3714,0,3714,3714,0,0,0,3714,0,0,3714,3714,3714,0,0,0,3714,51996,0,0,0,0,0,3714,3714,3714,3714]}}