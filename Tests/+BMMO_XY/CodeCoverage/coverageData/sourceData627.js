var sourceData627 = {"FileContents":["function test_suite = test_bmmo_add_output_corr\r","suite = initTestSuite2016(localfunctions);\r","if nargout==0\r","    suite.run();\r","else\r","    test_suite = suite;\r","end\r","\r","% add zero structure to itself: output should be same as input\r","function test_bmmo_add_output_corr_case1\r","\r","options = bmmo_default_options_structure;\r","options.susd_control = 1;\r","out = bmmo_default_output_structure(options);\r","\r","corr_new = bmmo_add_output_corr(out.corr, out.corr);\r","\r","bmmo_assert_equal(out.corr, corr_new);\r","\r","% add zero structure to random structure: output should be same as random\r","% structure. Also perform associativity test\r","function test_bmmo_add_output_corr_case2\r","\r","options = bmmo_default_options_structure;\r","options.susd_control = 1;\r","out_zero = bmmo_default_output_structure(options);\r","susd_ty_only = 1;\r","\r","out = sub_get_nonzero_output(out_zero, susd_ty_only);\r","\r","corr_new = bmmo_add_output_corr(out_zero.corr, out.corr);\r","bmmo_assert_equal(out.corr, corr_new);\r","\r","% associativity test\r","corr_new = bmmo_add_output_corr(out.corr, out_zero.corr);\r","bmmo_assert_equal(out.corr, corr_new);\r","\r","% add nonzero structure to its inverse; result should be zero\r","function test_bmmo_add_output_corr_case3\r","\r","options = bmmo_default_options_structure;\r","options.susd_control = 1;\r","out_zero = bmmo_default_output_structure(options);\r","susd_ty_only = 1;\r","out1 = sub_get_nonzero_output(out_zero, susd_ty_only);\r","out2 = out1;\r","\r","% make sure filter coefficients are all 1\r","options.filter.coefficients.WH = 1;\r","options.filter.coefficients.BAO = 1;\r","options.filter.coefficients.MI = 1;\r","options.filter.coefficients.KA = 1;\r","options.filter.coefficients.INTRAF = 1;\r","options.filter.coefficients.SUSD = 1;\r","\r","out2.corr = bmmo_apply_time_filter(out1.corr, options.filter.coefficients, -1);\r","\r","corr_new = bmmo_add_output_corr(out1.corr, out2.corr);\r","bmmo_assert_equal(out_zero.corr, corr_new);\r","\r","\r","% Only add TranslationY when adding SUSD corrections\r","function test_bmmo_add_output_corr_case4\r","\r","options = bmmo_default_options_structure;\r","out1 = bmmo_default_output_structure(options);\r","\r","susd_ty_only = 0;\r","out2 = sub_get_nonzero_output(out1, susd_ty_only);\r","\r","susd_ty_only = 1;\r","out3 = sub_get_nonzero_output(out1, susd_ty_only);\r","\r","corr_new = bmmo_add_output_corr(out1.corr, out2.corr);\r","\r","bmmo_assert_equal(out3.corr, corr_new);\r","\r","\r","function out = sub_get_nonzero_output(out_zero, susd_ty_only)\r","\r","% fill in structure with nonzero values\r","out = out_zero;\r","fn_bao = fieldnames(out.corr.BAO);\r","if susd_ty_only\r","    fn_susd = {'TranslationY'};\r","else\r","    fn_susd = fieldnames(out.corr.SUSD);\r","end\r","out.corr.IR2EUV = 6;\r","for ic = 1:2\r","   out.corr.MI.wse(ic).x_mirr.dx =  out.corr.MI.wse(ic).x_mirr.dx + 5e-9;\r","   out.corr.MI.wse(ic).y_mirr.dy =  out.corr.MI.wse(ic).y_mirr.dy + 5e-9;\r","   out.corr.KA.grid_2de(ic).dx = out.corr.KA.grid_2de(ic).dx + 4e-9;\r","   out.corr.KA.grid_2de(ic).dy = out.corr.KA.grid_2de(ic).dy + 4e-9;\r","   out.corr.ffp(ic).dx = out.corr.ffp(ic).dx + 3e-9;\r","   out.corr.ffp(ic).dy = out.corr.ffp(ic).dy + 3e-9;\r","   for ifield = 1:length(fn_susd)\r","        out.corr.SUSD(ic).(fn_susd{ifield}) = out.corr.SUSD(ic).(fn_susd{ifield}) + 2e-9;\r","   end\r","   for ifield = 1:length(fn_bao)\r","        out.corr.BAO(ic).(fn_bao{ifield}) = out.corr.BAO(ic).(fn_bao{ifield}) + 2e-9;\r","   end\r","end\r","out.corr.MI.wsm = out.corr.MI.wse;"],"CoverageData":{"CoveredLineNumbers":[],"UnhitLineNumbers":[2,3,4,5,6,12,13,14,16,18,24,25,26,27,29,31,32,35,36,41,42,43,44,45,46,49,50,51,52,53,54,56,58,59,65,66,68,69,71,72,74,76,82,83,84,85,86,87,89,90,91,92,93,94,95,96,97,98,100,101,104],"HitCount":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}}