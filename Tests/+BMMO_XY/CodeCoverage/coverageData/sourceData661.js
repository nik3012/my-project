var sourceData661 = {"FileContents":["%% history \r","%   2015-09-22 SBPR  creation\r","%   2018-12-11 SELR  removed parlist test in case 1\r","\r","function test_suite = test_bmmo_get_design_matrix\r","suite = initTestSuite2016(localfunctions);\r","if nargout==0\r","    suite.run();\r","else\r","    test_suite = suite;\r","end\r","\r","\r","%% 1 test with small wd, known output matrices\r","function test_bmmo_get_design_matrix_1 % ok<DEFNU>\r","\r","% make a small wd structure\r","wd.xc = [-3 -3 -3 0 0 0 3 3 3]';\r","wd.xf = [-1 0 1 -1 0 1 -1 0 1]';\r","wd.xw = wd.xc + wd.xf;\r","wd.yc = wd.xc;\r","wd.yf = wd.xf;\r","wd.yw = wd.xw;\r","\r","wds = size(wd.xc);\r","\r","%start with 10par: tx, ty, rs, ra, ms, ma, rws, rwa, mws, mwa\r","expected_matrix_x = [ones(wds), zeros(wds), -wd.yf, -wd.yf, wd.xf, wd.xf, -wd.yc, -wd.yc, wd.xc, wd.xc];\r","expected_matrix_y = [zeros(wds), ones(wds), wd.xf, -wd.xf, wd.yf, -wd.yf, wd.xc, -wd.xc, wd.yc, -wd.yc];\r","expected_matrix = [expected_matrix_x ; expected_matrix_y];\r","\r","options.parlist = bmmo_parlist;\r","\r","outmat_x = bmmo_get_design_matrix(wd, options, 'xonly', 'tx', 'ty', 'rs', 'ra', 'ms', 'ma', 'rws', 'rwa', 'mws', 'mwa');\r","outmat_y = bmmo_get_design_matrix(wd, options, 'yonly', 'tx', 'ty', 'rs', 'ra', 'ms', 'ma', 'rws', 'rwa', 'mws', 'mwa');\r","outmat = bmmo_get_design_matrix(wd, options, 'tx', 'ty', 'rs', 'ra', 'ms', 'ma', 'rws', 'rwa', 'mws', 'mwa');\r","outmat10p = bmmo_get_design_matrix(wd, options, '10par');\r","\r","options = rmfield(options, 'parlist');\r","outmat10p_default = bmmo_get_design_matrix(wd, options);\r","\r","bmmo_assert_equal(expected_matrix_x, outmat_x);\r","bmmo_assert_equal(expected_matrix_y, outmat_y);\r","bmmo_assert_equal(expected_matrix, outmat);\r","bmmo_assert_equal(outmat, outmat10p);\r","bmmo_assert_equal(outmat, outmat10p_default);\r","\r","%% 2 test 6par with dummy\r","function test_bmmo_get_design_matrix_2 % ok<DEFNU>\r","\r","mld = ovl_create_dummy('marklayout','BA-XY-DYNA-13X19','nwafer',6,'nlayer', 1);\r","wds = size(mld.wd.xc);\r","options.parlist = bmmo_parlist;\r","\r","expected_6par_out = [ones(wds), zeros(wds), -mld.wd.yc, -mld.wd.yc, mld.wd.xc, mld.wd.xc; ...\r","                     zeros(wds), ones(wds), mld.wd.xc, -mld.wd.xc, mld.wd.yc, -mld.wd.yc];\r","                 \r","outmat = bmmo_get_design_matrix(mld.wd, options, 'tx', 'ty', 'rws', 'rwa', 'mws', 'mwa');\r","outmat6p = bmmo_get_design_matrix(mld.wd, options, '6par');\r","\r","bmmo_assert_equal(expected_6par_out, outmat);\r","bmmo_assert_equal(outmat, outmat6p);\r","\r","%% 3 test K-factors with dummy\r","function test_bmmo_get_design_matrix_3 % ok<DEFNU>\r","\r","mld = ovl_create_dummy('marklayout','BA-XY-DYNA-13X19','nwafer',6,'nlayer', 1);\r","options.parlist = bmmo_parlist;\r","\r","x_f = mld.wd.xf;\r","y_f = mld.wd.yf;\r","\r","% odd K-factors have no dy component\r","expected_out = zeros(length(mld.wd.yc), 10);\r","outmat = bmmo_get_design_matrix(mld.wd, options, 'yonly', 'K1', 'K3', 'K5', 'K7', 'K9', 'K11', 'K13', 'K15', 'K17', 'K19');\r","bmmo_assert_equal(expected_out, outmat);\r","\r","% even K-factors have no dx component\r","outmat = bmmo_get_design_matrix(mld.wd, options, 'xonly', 'K2', 'K4', 'K6', 'K8', 'K10', 'K12', 'K14', 'K16', 'K18', 'K20');\r","bmmo_assert_equal(expected_out, outmat);\r","\r","% odd K-factors dx\r","expected_out =[ones(size(x_f)), x_f, y_f, x_f.^2, x_f.*y_f, y_f.^2, x_f.^3, x_f.^2.*y_f, x_f.*y_f.^2, y_f.^3];\r","outmat = bmmo_get_design_matrix(mld.wd, options, 'xonly', 'K1', 'K3', 'K5', 'K7', 'K9', 'K11', 'K13', 'K15', 'K17', 'K19');\r","bmmo_assert_equal(expected_out, outmat);\r","\r","% even K-factors dy\r","expected_out =[ones(size(y_f)), y_f, x_f, y_f.^2, y_f.*x_f, x_f.^2, y_f.^3, y_f.^2.*x_f, y_f.*x_f.^2, x_f.^3];\r","outmat = bmmo_get_design_matrix(mld.wd, options, 'yonly', 'K2', 'K4', 'K6', 'K8', 'K10', 'K12', 'K14', 'K16', 'K18', 'K20');\r","bmmo_assert_equal(expected_out, outmat);"],"CoverageData":{"CoveredLineNumbers":[],"UnhitLineNumbers":[6,7,8,9,10,18,19,20,21,22,23,25,28,29,30,32,34,35,36,37,39,40,42,43,44,45,46,51,52,53,55,56,58,59,61,62,67,68,70,71,74,75,76,79,80,83,84,85,88,89,90],"HitCount":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}}