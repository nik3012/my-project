var sourceData160 = {"FileContents":["function kmatrix  = bmmo_pars_to_k_factor_matrix(pars, nmark, nfield)\r","% function kmatrix  = bmmo_pars_to_k_factor_matrix(pars, nmark, nfield)\r","%\r","% Generate a correctly-scaled 18 * (nmark * nfield) K-factor matrix\r","% from the input 18par 1 * nfield structure\r","%\r","% Input: \r","%        pars: 1 * nfield ( or nfield * 1) 18 par structure with fields\r","%              as defined in EDS D000323756/D000810611\r","%        nfield: number of fields for which there are k-factors\r","%        nmark: number of marks per field\r","%\r","% Output: \r","%        Kmatrix: 18 * (nmark * nfield) K-factor matrix\r","\r","% Scaling factors\r","NM = 1;\r","UM = 1;\r","NM_CM2 = 1;\r","NM_CM3 = 1;\r","\r","% Template output matrix column with scaling factors\r","%      K1 K2 K3 K4 K5 K6 K7     K8     K9     K10    K11    K12    K14    K15    K16    K17    K18    K19   \r","col = [NM NM UM UM UM UM NM_CM2 NM_CM2 NM_CM2 NM_CM2 NM_CM2 NM_CM2 NM_CM3 NM_CM3 NM_CM3 NM_CM3 NM_CM3 NM_CM3]';\r","\r","% Tile the column to the size of the output matrix\r","kmatrix = repmat(col, 1, nfield);\r","\r","knames = fieldnames(pars(1));\r","numk = length(knames);\r","\r","% Generate a K-factor matrix for all fields in this wafer \r","for ik = 1:numk\r","   kmatrix(ik, :) = kmatrix(ik,:) .* [pars(1:nfield).(knames{ik})];\r","end\r","\r","% replace rows 3-6\r","k3 = kmatrix(3, :) + kmatrix(4,:); % K3 = ms + ma;\r","k4 = kmatrix(3, :) - kmatrix(4,:); % K4 = ms - ma;\r","k5 = -kmatrix(5,:) - kmatrix(6,:); % K5 = -rs - ra;\r","k6 = kmatrix(5,:) - kmatrix(6,:);  % K6 = rs - ra;\r","\r","\r","kmatrix(3,:) = k3;\r","kmatrix(4,:) = k4;\r","kmatrix(5,:) = k5;\r","kmatrix(6,:) = k6;\r","\r","% tile to nmark size\r","kmatrix = repmat(kmatrix, nmark, 1);\r","\r","% reshape to put marks per field in columns\r","kmatrix = reshape(kmatrix, numk, []);\r","\r",""],"CoverageData":{"CoveredLineNumbers":[17,18,19,20,24,27,29,30,33,34,38,39,40,41,44,45,46,47,50,53],"UnhitLineNumbers":[],"HitCount":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,917,917,917,917,0,0,0,917,0,0,917,0,917,917,0,0,917,16506,0,0,0,917,917,917,917,0,0,917,917,917,917,0,0,917,0,0,917,0,0]}}