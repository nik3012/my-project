var sourceData90 = {"FileContents":["function [mlo, options] = bmmo_field_reconstruction(mli, options)\r","% function [mlo, options] = bmmo_field_reconstruction(mli, options)\r","%\r","% Given an input layout, this function reconstructs the layout used by NXE BMMO \r","% drift control, by mapping to a generated 13x19 layout based on\r","% the field centres and field ordering in mli.expinfo\r","%\r","% Input:\r","% mli:      input layout containing an expinfo substructure as defined in the\r","%           EDS\r","% options:  options structure\r","%\r","% Output:\r","% mlo:      reconstructed ml struct\r","% options:  options structure (layer_fields possibly changed)\r","% \r","% For details of the model and definitions of in/out interfaces, refer to\r","% D000323756 EDS BMMO NXE drift control model\r","\r","tolerance_exponent = 12; % tolerance for layout mark equality is 10^-12 m\r","\r","% build target layouts per layer\r","mlo = bmmo_construct_layout_from_ml(mli, options);\r","\r","for ilayer = 1:length(mlo)\r","    % shift fields to measurement position\r","    mlo(ilayer) = bmmo_shift_fields(mlo(ilayer), options.x_shift, options.y_shift, ilayer);\r","\r","    % map input layout to shifted exposure layout, with fields in exposure\r","    % sort order\r","    mlo(ilayer) = bmmo_map_layouts(mli, mlo(ilayer), tolerance_exponent);\r","\r","    % shift mapped fields to exposure position\r","    mlo(ilayer) = bmmo_shift_fields(mlo(ilayer), -options.x_shift, -options.y_shift);\r","end\r","\r","% combine the layers if there is more than one layer\r","if length(mlo) > 1\r","    mlo = bmmo_combine_fields(mlo(1), mlo(2), 1:mlo(2).nfield);\r","end\r","\r","% fix layer_fields depending on input data\r","if mlo.nfield < min(options.edge_fields)\r","    options.layer_fields{1} = 1:mlo.nfield;\r","    options.layer_fields = options.layer_fields(1);\r","end\r","\r","\r",""],"CoverageData":{"CoveredLineNumbers":[20,23,25,27,31,34,38,39,43,44,45],"UnhitLineNumbers":[],"HitCount":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,175,0,0,175,0,175,0,347,0,0,0,347,0,0,347,0,0,0,175,172,0,0,0,175,45,45,0,0,0,0]}}