var sourceData116 = {"FileContents":["function [pi_struct, kfactors] = bmmo_get_delta_hoc_pi_per_chuck(inter_corr, model_results, options)\r","% function [pi_struct, kfactors] = bmmo_get_delta_hoc_pi_per_chuck(inter_corr, model_results, options)\r","%\r","% Get k-factor delta KPI: difference between intrafield k-factors\r","% calculated on 7x7 full fields, vs 13x19 dense fields\r","%\r","% Input:\r","%   inter_corr: unfiltered interfield SBC2 delta correction (WH + MI + KA + BAO)\r","%   model_results: intermediate model results containing ml_outlier_removed\r","%   options: BMMO/BL3 options structure\r","%\r","% Output:\r","%   pi_struct: KPI structure with 20(35) par values per chuck\r","%   kfactors: delta 20(35) par values per chuck\r","%   20par or 35par depending on options.intraf_actuation_order\r","\r","% get the 20(35)par fit for the 7x7 downsampled interfield residual (L1 only)\r","interfield_res = ovl_add(model_results.ml_outlier_removed, inter_corr);\r","interfield_res = bmmo_get_layout(ovl_get_fields(interfield_res, options.layer_fields{1}), options.reduced_reticle_layout, options);\r","\r","intraf = bmmo_average_chuck(ovl_average_fields(bmmo_get_innerfields(interfield_res, options)), options);\r","intraf = ovl_combine_wafers(intraf(1), intraf(2));\r","\r","intraf = bmmo_correct_intrafield_shift(intraf, options);\r","tmp_options = options;\r","tmp_options.chuck_usage.chuck_id = [1 2];\r","tmp_options.chuck_usage.chuck_id_used = [1 2];\r","    \r","kfactors = bmmo_get_kfactors_per_chuck(intraf, tmp_options);\r","\r","% subtract 20(35)par kfactors from 12 dense fields\r","% these have already been calculated in the model\r","kfn = fieldnames(kfactors);\r","for ic = 1:2\r","    for ik = 1:length(kfn)  \r","        kfactors(ic).(kfn{ik}) = kfactors(ic).(kfn{ik}) - model_results.INTRAF.Calib_Kfactors(ic).(kfn{ik});\r","    end\r","end\r","\r","% generate PI struct\r","pi_struct = bmmo_get_hoc_pi_struct(kfactors, '_compare_delta', options);\r","\r",""],"CoverageData":{"CoveredLineNumbers":[18,19,21,22,24,25,26,27,29,33,34,35,36,41],"UnhitLineNumbers":[],"HitCount":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,122,122,0,122,122,0,122,122,122,122,0,122,0,0,0,122,122,244,4880,0,0,0,0,122,0,0]}}