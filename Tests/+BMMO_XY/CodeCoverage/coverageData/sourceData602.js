var sourceData602 = {"FileContents":["function [max_dx,max_dy,max_msdx,max_msdy, dx, dy] = JIMI_calc_profile_fading_v3(ml_in, p_in,varargin )\r","%calc_profile_fading : estimates fading (x,y and z) as result of polynomial profiles of RS/WS\r","%   For every mark in the ml struct dteremine the RS and WS setpoint for 5\r","%   y-positions in the slit. Based on these setpoints determine the effect\r","%   on Z2, Z3 and Z4. Using the sensitivities, this result is a dx,dy,dz\r","%   for each of the 5 positions in the slit. \r","%   Using the illumination weights the average(dynamic) effect can be\r","%   calculated and also the fading (MSD)\r","\r","optionsDef.lenstype      = '3400_34';\r","%[options, arguments] = ovl_parse_options(optionsDef, varargin{:}); % do NOT remove {:} because this is needed for Matlab varargin syntax\r","\r","%% load data using LMtwin toolbox\r","try\r","    lm_load_definition(optionsDef.lenstype);\r","catch\r","    lm_twin_path = '\\\\asml.com\\eu\\shared\\nl011032\\tis-lq\\Matlab_Tools\\lm_twin_tng\\WIP';\r","    warning(['Cannot load LM definitions. Adding path to lm_twin: ' lm_twin_path]); \r","    addpath \\\\asml.com\\eu\\shared\\nl011032\\tis-lq\\Matlab_Tools\\lm_twin_tng\\WIP\r","    try\r","        lm_load_definition(optionsDef.lenstype);\r","    catch\r","        error([sprintf('You need access to the following network share:\\n') ...\r","               '   \\\\asml.com\\eu\\shared\\nl011032\\tis-lq\\Matlab_Tools\\lm_twin\\WIP' ...\r","               sprintf('\\nPlease use the IT service request form ''Access to Network Shares (read/write)'':\\n') ...\r","               sprintf('   http://netscanner.asml.com/nl017015/nonconf/request_forms.html\\n')]);\r","    end\r","end\r","\r","\r","lensdata.X = Generic.Lens.Grid.X(1, :) * 1e-3; % [mm] -> [m]\r","lensdata.Y = Generic.Lens.Grid.Y       * 1e-3;       % [mm] -> [m]\r","lensdata.W = Generic.Lens.Slit_Weights;\r","\r","lensdata.obj_z_id = find(strcmp(cellstr(Generic.Manipulator.Name), 'Reticle.Z'));\r","lensdata.obj_Rx_id = find(strcmp(cellstr(Generic.Manipulator.Name), 'Reticle.Rx'));\r","lensdata.obj_Ry_id = find(strcmp(cellstr(Generic.Manipulator.Name), 'Reticle.Ry'));\r","lensdata.img_x_id = find(strcmp(cellstr(Generic.Manipulator.Name), 'Wafer.X'));\r","lensdata.img_y_id = find(strcmp(cellstr(Generic.Manipulator.Name), 'Wafer.Y'));\r","lensdata.img_z_id = find(strcmp(cellstr(Generic.Manipulator.Name), 'Wafer.Z'));\r","lensdata.img_Rz_id = find(strcmp(cellstr(Generic.Manipulator.Name), 'Wafer.Rz'));\r","lensdata.img_Rx_id = find(strcmp(cellstr(Generic.Manipulator.Name), 'Wafer.Rx'));\r","lensdata.img_Ry_id = find(strcmp(cellstr(Generic.Manipulator.Name), 'Wafer.Ry'));\r","\r","for p_i = 1:length(p_in.static)\r","    switch p_in.static(p_i).name\r","        case 'bipx0'\r","            x_poly(4) = p_in.static(p_i).value;\r","        case 'bipx1'\r","            x_poly(3) = p_in.static(p_i).value;\r","        case 'bipx2'\r","            x_poly(2) = p_in.static(p_i).value;\r","        case 'bipx3'\r","            x_poly(1) = p_in.static(p_i).value;\r","        case 'bipy0'\r","            y_poly(4) = p_in.static(p_i).value;\r","        case 'bipy1'\r","            y_poly(3) = p_in.static(p_i).value;\r","        case 'bipy2'\r","            y_poly(2) = p_in.static(p_i).value;\r","        case 'bipy3'\r","            y_poly(1) = p_in.static(p_i).value;\r","        case 'biprz0'\r","            rz_poly(3) = p_in.static(p_i).value;\r","        case 'biprz1'\r","            rz_poly(2) = p_in.static(p_i).value;\r","        case 'biprz2'\r","            rz_poly(1) = p_in.static(p_i).value;\r","        case 'bopz0'\r","            z_poly(3) = p_in.static(p_i).value;\r","        case 'bopz1'\r","            z_poly(2) = p_in.static(p_i).value;\r","        case 'bopz2'\r","            z_poly(1) = p_in.static(p_i).value;\r","        case 'boprx0'\r","            rx_poly(3) = p_in.static(p_i).value;\r","        case 'boprx1'\r","            rx_poly(2) = p_in.static(p_i).value;\r","        case 'boprx2'\r","            rx_poly(1) = p_in.static(p_i).value;\r","        case 'bopry0'\r","            ry_poly(3) = p_in.static(p_i).value;\r","        case 'bopry1'\r","            ry_poly(2) = p_in.static(p_i).value;\r","        case 'bopry2'\r","            ry_poly(1) = p_in.static(p_i).value;\r","    end\r","end\r","\r","for kk = 1:length(ml_in.wd.xf)\r","    abs_dif_x = abs(ml_in.wd.xf(kk) - lensdata.X);\r","    xi(kk)=find(abs_dif_x == min(abs_dif_x));\r","end\r","\r","for offset = 1:size(lensdata.Y,1)\r","    % determine position of stages during the scan\r","    s_t_y = ml_in.wd.yf - lensdata.Y(offset,xi)';\r","    slit_y=lensdata.Y(offset,xi)';\r","    rs_z  = polyval(z_poly,s_t_y*4);\r","    rs_rx = polyval(rx_poly,s_t_y*4);\r","    rs_ry = polyval(ry_poly,s_t_y*4);\r","    ws_x  = polyval(x_poly,s_t_y);\r","    ws_y  = polyval(y_poly,s_t_y);\r","    ws_rz = polyval(rz_poly,s_t_y);\r","    % Note that\r","    % Generic.Lens.Factors.dZ2_dX=Generic.Lens.Factors.dZ3_dY=-0.33=-NA\r","    LD_z2_to_rsZ=Generic.Manipulator.Dependency(offset, xi', 2, lensdata.obj_z_id)*1/Generic.Lens.Factors.dZ2_dX*1e-3;\r","    LD_z3_to_rsZ=Generic.Manipulator.Dependency(offset, xi', 3, lensdata.obj_z_id)*1/Generic.Lens.Factors.dZ3_dY*1e-3;\r","    \r","    obj_common=rs_z'+4*rs_rx'.*slit_y'-4*rs_ry'.*ml_in.wd.xf';\r","    \r","    dx(offset, :)= ((ws_x'- ws_rz'.*slit_y')+LD_z2_to_rsZ.*obj_common);\r","    dy(offset, :)= ((ws_y'+ ws_rz'.*ml_in.wd.xf')+LD_z3_to_rsZ.*obj_common);\r","    \r","end\r","Wi = lensdata.W(:,xi);\r","\r","m_dx = sum(dx .* Wi);\r","m_dy = sum(dy .* Wi);\r","\r","f_dx = dx - ones(size(dx,1),1) * m_dx;\r","f_dy = dy - ones(size(dy,1),1) * m_dy;\r","\r","msd_x = sqrt(sum(f_dx.^2 .* Wi.^2)./sum(Wi.^2));\r","msd_y = sqrt(sum(f_dy.^2 .* Wi.^2)./sum(Wi.^2));\r","\r","% figure,\r","% subplot(221),\r","% sc_=quivers(ml_in.wd.xf*1e3,ml_in.wd.yf*1e3,m_dx',m_dy');\r","% hold on\r","% quivers(ml_in.wd.xf*1e3,ml_in.wd.yf*1e3,ml_in.layer.wr.dx,ml_in.layer.wr.dy,sc_,'r');axis equal\r","% axis equal\r","% \r","% title('Scan integrated distortion (blue) and iHOPC model (red)')\r","% xlabel('full field x-pos [mm]')\r","% ylabel('full field y-pos [mm]')\r","% \r","% %figure,\r","% subplot(222)\r","% hold on,quivers(ml_in.wd.xf*1e3,ml_in.wd.yf*1e3,dx(1,:)',dy(1,:)',sc_,int2color(1));\r","% hold on,quivers(ml_in.wd.xf*1e3,ml_in.wd.yf*1e3,dx(2,:)',dy(2,:)',sc_,int2color(2));\r","% hold on,quivers(ml_in.wd.xf*1e3,ml_in.wd.yf*1e3,dx(3,:)',dy(3,:)',sc_,int2color(3));\r","% hold on,quivers(ml_in.wd.xf*1e3,ml_in.wd.yf*1e3,dx(4,:)',dy(4,:)',sc_,int2color(4));\r","% hold on,quivers(ml_in.wd.xf*1e3,ml_in.wd.yf*1e3,dx(5,:)',dy(5,:)',sc_,int2color(5));\r","% axis equal\r","% title('Scan static distortion (5 slit y-pos)')\r","% xlabel('full field x-pos [mm]')\r","% ylabel('full field y-pos [mm]')\r","% \r","% \r","[d,xyi]=sort(ml_in.wd.yf+1e-3*ml_in.wd.xf);\r","\r","Xs = reshape(ml_in.wd.xf(xyi),13,19);\r","Ys = reshape(ml_in.wd.yf(xyi),13,19);\r","fad_Xs = reshape(msd_x(xyi),13,19);\r","fad_Ys = reshape(msd_y(xyi),13,19);\r","\r","% figure\r","% subplot(223)\r","% surf(Xs*1e3,Ys*1e3,fad_Xs*1e9); view(2), colorbar, shading interp\r","% title('MSD in x-direction [nm]')\r","% xlabel('full field x-pos [mm]')\r","% ylabel('full field y-pos [mm]')\r","% \r","% \r","% subplot(224)\r","% surf(Xs*1e3,Ys*1e3,fad_Ys*1e9); view(2), colorbar, shading interp\r","% title('MSD in y-direction [nm]')\r","% xlabel('full field x-pos [mm]')\r","% ylabel('full field y-pos [mm]')\r","\r","\r","\r","max_dx=max(abs(m_dx));\r","max_dy=max(abs(m_dy));\r","max_msdx=max(abs(msd_x));\r","max_msdy=max(abs(msd_y));\r","\r","\r","    "],"CoverageData":{"CoveredLineNumbers":[],"UnhitLineNumbers":[10,14,15,16,17,18,19,20,21,22,23,25,26,31,32,33,35,36,37,38,39,40,41,42,43,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,90,91,92,95,97,98,99,100,101,102,103,104,107,108,110,112,113,116,118,119,121,122,124,125,151,153,154,155,156,174,175,176,177],"HitCount":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}}