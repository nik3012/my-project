var sourceData494 = {"FileContents":["function [expinfo, scan_direction] = bmmo_kt_expinfo_subset(ml, expinfo, scan_direction)\r","% function [expinfo, scan_direction] = bmmo_kt_expinfo_subset(ml, expinfo, scan_direction)\r","\r","% This function takes as input an ml, exposure field centers in expinfo,\r","% and scan directions per field. It will match the exposure information to\r","% the field centers found in the ml. The outputs are the expinfo and\r","% scan_direction that match with ml.\r","% Input\r","%   ml: ml structure to which exposure info will be matched\r","%   expinfo: structure containing exposure field centers\r","%   scan_direction: vector of scan directions per exposure field\r","%\r","% Output:\r","%   expinfo: structure with the exposure field centers that match the input ml\r","%   scan_direction: vector of scan directions per field matching the input ml\r","\r","mlFieldCenters = unique([ml.wd.xc, ml.wd.yc], 'rows');\r","expinfoFieldCenters = [expinfo.xc, expinfo.yc];\r","\r","numberOfFieldsInMl = length(mlFieldCenters);\r","numberOfFieldsInExpinfo = length(expinfo.xc);\r","numberOfScanDirections = length(scan_direction);\r","\r","% Check the number of fields in the inputs; throw errors if needed\r","assert(numberOfFieldsInExpinfo == numberOfScanDirections,       ...\r","       ['Invalid input: Number of exposure field centers (%d)', ...\r","        ' does not match number of scan directions (%d)'],      ...\r","        numberOfFieldsInExpinfo, numberOfScanDirections);\r","        \r","assert(numberOfFieldsInExpinfo >= numberOfFieldsInMl, ...\r","      ['Number of exposure field centers (%d) is smaller than the number'       , ...\r","       ' of field centers in the input overlay (%d). A mapping cannot be made.'], ...\r","       numberOfFieldsInExpinfo, numberOfFieldsInMl);\r","\r","% Find field centers that are both in expinfoFieldCenters and\r","% mlFieldCenters; then check if this covers all fields in ml.\r","overlappingExpinfoFieldCenters = ismembertol(expinfoFieldCenters, mlFieldCenters, 1e-9, 'byRows', true, 'DataScale', 1);\r","\r","assert(sum(overlappingExpinfoFieldCenters) == numberOfFieldsInMl, ...\r","      ('Exposure information was not found for all fields in the input ml, a mapping could not be made.'));\r","  \r","% Select the right subset of exposure field centers to output\r","expinfo.xc = expinfo.xc(overlappingExpinfoFieldCenters);\r","expinfo.yc = expinfo.yc(overlappingExpinfoFieldCenters);\r","expinfo.v = zeros(size(expinfo.xc));\r","scan_direction = scan_direction(overlappingExpinfoFieldCenters);\r","% Since fields are now in exposure order, mapping field to expose is 1:nfield\r","expinfo.map_fieldtoexp = (1:ml.nfield)';\r","end\r","\r",""],"CoverageData":{"CoveredLineNumbers":[17,18,20,21,22,25,28,30,33,37,39,43,44,45,46,48],"UnhitLineNumbers":[],"HitCount":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,0,4,4,4,0,0,4,0,0,4,0,4,0,0,4,0,0,0,4,0,4,0,0,0,4,4,4,4,0,4,0,0,0]}}