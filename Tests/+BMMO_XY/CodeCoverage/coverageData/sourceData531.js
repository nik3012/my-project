var sourceData531 = {"FileContents":["function [corr_out, res_out] = bmmo_update_corr_inlinesdm(corr_in, options)\r","% function [corr_out, res_out] = bmmo_update_corr_inlinesdm(corr_in)\r","%\r","% Update sbc intrafield correction with inlineSDM model\r","%\r","% Input: corr_in: BMMO-NXE SBC2 correction structure\r","%\r","% Output: corr_out: BMMO-NXE SBC2 correction structure after inline SDM\r","%            residual removed\r","%         res_out: modelled inline SDM residual\r","%\r","% 20200710 JIMI Update intrafield actuation with cet model type in existing\r","% bmmo_update_corr_inlinesdm\r","\r","if nargin < 2\r","    options = bmmo_default_options_structure;\r","end\r","\r","mld = ovl_average_fields(ovl_create_dummy('13X19', 'nlayer', 1, 'nwafer', 2));\r","corr_out = corr_in;\r","flds = bmmo_ffp_to_ml(corr_in.ffp, mld);\r","\r","if options.intraf_actuation_order == 3\r","    [~, ~, ~, ~, res] = bmmo_model_inlineSDM(ovl_get_wafers(flds, 1), ...\r","        ovl_get_wafers(flds, 2), 'LFP', 0, 'CET_model', '');\r","elseif options.intraf_actuation_order == 5\r","    [~, ~, ~, ~, res, ~]= bmmo_model_inlineSDM(ovl_get_wafers(flds, 1), ...\r","        ovl_get_wafers(flds, 2), 'LFP', 0, 'CET_model', 'ovo3');\r","else\r","    error('Wrong inline SDM options');\r","end\r","I = knnsearch([mld.wd.xf mld.wd.yf], [corr_out.ffp(1).x corr_out.ffp(1).y]);\r","for jj = 1:2\r","    res_out(jj).dx = res.TotalRes(jj).dx(I);\r","    res_out(jj).dy = res.TotalRes(jj).dy(I);\r","    res_out(jj).x = corr_out.ffp(jj).x;\r","    res_out(jj).y = corr_out.ffp(jj).y;\r","    corr_out.ffp(jj).dx = corr_out.ffp(jj).dx - res_out(jj).dx;\r","    corr_out.ffp(jj).dy = corr_out.ffp(jj).dy - res_out(jj).dy;\r","end\r",""],"CoverageData":{"CoveredLineNumbers":[],"UnhitLineNumbers":[15,16,19,20,21,23,24,25,26,27,28,29,30,32,33,34,35,36,37,38,39],"HitCount":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}}